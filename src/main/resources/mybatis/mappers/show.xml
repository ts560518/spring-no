<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.dao.ShowDao">
	
	<select id="getAllShows" resultType="Show">
	select
         A.show_no             as no,
         A.category_no         as categoryNo,
         A.show_name           as name,      
         A.viewing_no          as viewingNo,
         A.running_time        as runningTime,
         A.poster_img          as posterImg,
         A.begin_date          as beginDate,
         A.end_date            as endDate,
         A.place_no            as placeNo,
         B.place_name          as placeName,
         A.attention_img       as attentionImg,
         A.sale_img            as saleImg,
         A.show_detail_img     as showDetailImg,
         A.show_created_date   as createdDate
      from
         shows A, show_place B
       where 
         A.place_no = B.place_no
      and
      	 A.end_date > sysdate
         
	</select>
	
	<select id="getShowByLocalName" resultType="Show" parameterType="string">
		select
         A.show_no             as no,
         A.category_no         as categoryNo,
         A.show_name           as name,      
         A.viewing_no          as viewingNo,
         A.running_time        as runningTime,
         A.poster_img          as posterImg,
         A.begin_date          as beginDate,
         A.end_date            as endDate,
         A.place_no            as placeNo,
         B.place_name          as placeName,
         A.attention_img       as attentionImg,
         A.sale_img            as saleImg,
         A.show_detail_img     as showDetailImg,
         A.show_created_date   as createdDate
      from
         shows A, show_place B
      where
      	  A.place_no = B.place_no
      	  and a.end_date > sysdate
      and
         B.local_name = #{localName}
	</select>
	
	
	
	<select id="getputSeat" resultType="ShowSeat">
		select 
			SEAT_NO			AS no,
			SHOW_SEAT_NO	AS showSeatNo,
			PUT_SHOW_NO		AS putShowNo,
			TICKET			AS ticket
		from
			show_seat
		where
			PUT_SHOW_NO = #{putShowNo}
	</select>
	
	<select id="getCategorySwiper" resultType="Show">
		select 
        	SHOW_NO            AS no,
       		SHOW_NAME          AS name,      
         	VIEWING_NO         AS viewingNo,
         	RUNNING_TIME       AS runningTime,
         	POSTER_IMG         AS posterImg,
         	BEGIN_DATE         AS beginDate,
         	END_DATE           AS endDate,
         	PLACE_NO           AS placeNo,
         	ATTENTION_IMG      AS attentionImg,
         	SALE_IMG           AS saleImg,
         	SHOW_DETAIL_IMG    AS showDetailImg,
         	show_created_date  AS createdDate
      	from (
      		select
         		*
     		from
         		shows A, show_categories B
        	where 
        		b.top_category_no = #{catno}
        	and
        		a.category_no = b.category_no
      		order by 
         	begin_date desc
        )
     	where 
         rownum&lt;=4
	</select>
	<select id="getShowsHome" resultType="Show">
		select 
			SHOW_NO				AS no,
			CATEGORY_NO			AS categoryNo,
			SHOW_NAME			AS name,		
			VIEWING_NO			AS viewingNo,
			RUNNING_TIME		AS runningTime,
			POSTER_IMG			AS posterImg,
			BEGIN_DATE			AS beginDate,
			END_DATE			AS endDate,
			PLACE_NO			AS placeNo,
			ATTENTION_IMG		AS attentionImg,
			SALE_IMG			AS saleImg,
			SHOW_DETAIL_IMG		AS showDetailImg,
			show_created_date	AS createdDate
		from (
		select
			*
		from
			shows
		order by 
			begin_date desc
			)
		where 
			rownum&lt;=3 
	</select>

	<select id="getAllCategoryShows" resultType="Show">
		select
			A.SHOW_NO				AS no,
			A.CATEGORY_NO			AS categoryNo,
			A.SHOW_NAME			    AS name,		
			A.VIEWING_NO			AS viewingNo,
			A.RUNNING_TIME		    AS runningTime,
			A.POSTER_IMG			AS posterImg,
			A.BEGIN_DATE			AS beginDate,
			A.END_DATE			    AS endDate,
			A.PLACE_NO			    AS placeNo,
            B.PLACE_NAME            AS placeName,
			A.ATTENTION_IMG		    AS attentionImg,
			A.SALE_IMG			    AS saleImg,
			A.SHOW_DETAIL_IMG		AS showDetailImg,
			A.show_created_date	    AS createdDate
		from
			shows A, show_place B
		where
			category_no = #{catno}
            and A.place_No = B.place_no
	</select>
	
	
	<select id="getOneCategoryShow" resultType="TotalShow">
		select
			A.SHOW_NO					AS no,
			A.CATEGORY_NO				AS categoryNo,
			A.SHOW_NAME					AS showName,		
			A.VIEWING_NO				AS viewingNo,
			C.VIEWING_GRADE_SD			AS viewingGradeSd,
			C.VIEWING_GRADE_NAME		AS viewingGradeName,
			A.RUNNING_TIME				AS runningTime,
			A.POSTER_IMG				AS posterImg,
			A.BEGIN_DATE				AS beginDate,
			A.END_DATE					AS endDate,
			A.PLACE_NO					AS placeNo,
            B.PLACE_NAME         		AS placeName,
            B.PLACE_ADDRESS				AS placeAddress,
			A.ATTENTION_IMG				AS attentionImg,
			A.SALE_IMG					AS saleImg,
			A.SHOW_DETAIL_IMG			AS showDetailImg,
			A.show_created_date			AS createdDate
		from
			shows A, show_place B, show_viewing_grades C
		where
			show_no = #{no}
            and A.place_No = B.place_no
            and A.VIEWING_NO = C.VIEWING_NO
	</select>
	
	<select id="getShowPutShows" resultType="PutShows">
		SELECT
			PUT_SHOW_NO			AS putShowNo,
			SHOW_NO				AS showNo,
			SHOW_DAY			AS day,
			SHOW_START_TIME		AS startTime
		FROM
			SHOW_PUT_SHOWS
		WHERE
			SHOW_NO = #{showNo}
	</select>
</mapper>